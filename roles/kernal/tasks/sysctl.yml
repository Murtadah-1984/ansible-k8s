---
# Sysctl Parameters Configuration
# Configures network parameters required by Kubernetes

# ============================================================================
# SYSCTL PARAMETERS FOR KUBERNETES
# ============================================================================
- name: Configure sysctl parameters for Kubernetes
  copy:
    dest: /etc/sysctl.d/k8s-kernel.conf
    content: |
      # sysctl params required by Kubernetes setup
      net.bridge.bridge-nf-call-iptables  = 1
      net.bridge.bridge-nf-call-ip6tables = 1
      net.ipv4.ip_forward                 = 1
    mode: '0644'
    owner: root
    group: root

- name: Apply sysctl parameters
  command: sysctl --system
  changed_when: true
  failed_when: false

